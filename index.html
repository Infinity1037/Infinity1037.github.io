<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="theme-color" id="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <!-- 预连接 Firebase 加速加载 -->
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://shared-cat-default-rtdb.asia-southeast1.firebasedatabase.app" crossorigin>
    <link rel="dns-prefetch" href="https://www.gstatic.com">
    <title>Yian的猫</title>
    <meta name="description" content="Yian的猫咪虚拟宠物，和朋友一起养猫~">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="background-overlay"></div>
    <div class="weather-layer" id="weather-layer"></div>

    <!-- Auth Screen -->
    <div class="auth-screen" id="auth-screen">
        <div class="auth-content">
            <div class="auth-cat">
                <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="100" cy="110" r="60" fill="#FFFFFF" opacity="0.3" />
                    <circle cx="100" cy="80" r="55" fill="#FFFFFF" opacity="0.3" />
                    <path d="M60 55 L45 20 L85 45 Z" fill="#FFFFFF" opacity="0.3" />
                    <path d="M140 55 L155 20 L115 45 Z" fill="#FFFFFF" opacity="0.3" />
                </svg>
            </div>
            <div class="auth-title">喵~ 说出暗号</div>
            <div class="auth-input-wrap">
                <input type="password" id="auth-input" class="auth-input" placeholder="悄悄告诉我~" autocomplete="off" inputmode="text" maxlength="32">
            </div>
            <button class="auth-btn" id="auth-btn">进入猫窝</button>
            <div class="auth-error" id="auth-error"></div>
        </div>
    </div>

    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen" style="display:none;">
        <div class="loading-content">
            <div class="loading-cat">
                <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="100" cy="110" r="60" fill="#FFFFFF" opacity="0.3" />
                    <circle cx="100" cy="80" r="55" fill="#FFFFFF" opacity="0.3" />
                    <path d="M60 55 L45 20 L85 45 Z" fill="#FFFFFF" opacity="0.3" />
                    <path d="M140 55 L155 20 L115 45 Z" fill="#FFFFFF" opacity="0.3" />
                </svg>
            </div>
            <div class="loading-text" id="loading-text">正在连接</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
            <button class="retry-btn" id="retry-btn">点击重试</button>
        </div>
    </div>

    <main class="container" id="main-content" style="opacity: 0;">
        <div class="greeting-box">
            <h1 id="greeting">早上好</h1>
            <p class="subtitle">愿咪拥有美好的一天</p>

            <div class="cat-area">
                <!-- 接鱼小游戏容器 -->
                <div class="fish-pond" id="fish-pond"></div>

                <!-- 猫咪对话 -->
                <div class="cat-speech" id="cat-speech">今天心情不错~</div>

                <!-- 猫咪（添加浮动动画） -->
                <div class="cat-wrapper">
                    <div class="cat-static" id="cat">
                        <svg class="cat-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="100" cy="110" r="60" fill="#FFFFFF" />
                            <circle cx="100" cy="80" r="55" fill="#FFFFFF" />
                            <path d="M60 55 L45 20 L85 45 Z" fill="#FFFFFF" />
                            <path d="M140 55 L155 20 L115 45 Z" fill="#FFFFFF" />
                            <path d="M62 53 L52 28 L82 47 Z" fill="#FFB7B2" />
                            <path d="M138 53 L148 28 L118 47 Z" fill="#FFB7B2" />
                            <g id="eyes-normal" class="eye">
                                <circle cx="80" cy="80" r="6" fill="#333" />
                                <circle cx="120" cy="80" r="6" fill="#333" />
                            </g>
                            <g id="eyes-happy" style="display:none;" class="eye">
                                <path d="M74 80 Q80 75 86 80" fill="none" stroke="#333" stroke-width="3"
                                    stroke-linecap="round" />
                                <path d="M114 80 Q120 75 126 80" fill="none" stroke="#333" stroke-width="3"
                                    stroke-linecap="round" />
                            </g>
                            <g id="eyes-sad" style="display:none;">
                                <path d="M74 82 Q80 87 86 82" fill="none" stroke="#333" stroke-width="3"
                                    stroke-linecap="round" />
                                <path d="M114 82 Q120 87 126 82" fill="none" stroke="#333" stroke-width="3"
                                    stroke-linecap="round" />
                            </g>
                            <g id="eyes-sleep" style="display:none;">
                                <line x1="74" y1="80" x2="86" y2="80" stroke="#333" stroke-width="3" stroke-linecap="round" />
                                <line x1="114" y1="80" x2="126" y2="80" stroke="#333" stroke-width="3" stroke-linecap="round" />
                            </g>
                            <path d="M95 95 Q100 100 105 95" fill="none" stroke="#333" stroke-width="4"
                                stroke-linecap="round" />
                            <ellipse cx="65" cy="95" rx="8" ry="4" fill="#FFB7B2" opacity="0.7" />
                            <ellipse cx="135" cy="95" rx="8" ry="4" fill="#FFB7B2" opacity="0.7" />
                            <ellipse cx="70" cy="170" rx="12" ry="10" fill="#FFFFFF" />
                            <ellipse cx="130" cy="170" rx="12" ry="10" fill="#FFFFFF" />
                            <path d="M160 140 Q180 135 170 115 Q160 100 140 120" fill="none" stroke="#FFFFFF"
                                stroke-width="12" stroke-linecap="round" />
                        </svg>
                        <div class="meow-bubble" id="meow-bubble">喵~</div>
                    </div>
                </div>

                <!-- 属性条（带数值） -->
                <div class="stats-simple">
                    <div class="stat-item" id="hunger-row">
                        <span class="stat-icon">🍖</span>
                        <div class="stat-bar">
                            <div class="stat-fill hunger" id="hunger-fill"></div>
                        </div>
                        <span class="stat-num" id="hunger-num">80%</span>
                    </div>
                    <div class="stat-item" id="mood-row">
                        <span class="stat-icon">💖</span>
                        <div class="stat-bar">
                            <div class="stat-fill mood" id="mood-fill"></div>
                        </div>
                        <span class="stat-num" id="mood-num">70%</span>
                    </div>
                    <div class="stat-item" id="energy-row">
                        <span class="stat-icon">⚡</span>
                        <div class="stat-bar">
                            <div class="stat-fill energy" id="energy-fill"></div>
                        </div>
                        <span class="stat-num" id="energy-num">60%</span>
                    </div>
                </div>

                <!-- 按钮 -->
                <div class="cat-actions">
                    <button class="action-btn feed-btn" id="feed-btn">
                        <span class="btn-icon">🐟</span>
                        <span class="btn-text">喂食</span>
                    </button>
                    <button class="action-btn pet-btn" id="pet-btn">
                        <span class="btn-icon">🖐️</span>
                        <span class="btn-text">抚摸</span>
                    </button>
                    <button class="action-btn play-btn" id="play-btn">
                        <span class="btn-icon">🎾</span>
                        <span class="btn-text">玩耍</span>
                    </button>
                </div>

                <!-- 统计 + 徽章 -->
                <div class="stats-info">
                    <div class="stats-row">
                        <span>Lv.<span id="cat-level">1</span></span>
                        <span class="stats-divider">·</span>
                        <span>喂食 <span id="total-feeds">0</span></span>
                        <span class="stats-divider">·</span>
                        <span>互动 <span id="total-pets">0</span></span>
                        <span class="stats-divider">·</span>
                        <span>玩耍 <span id="total-plays">0</span></span>
                    </div>
                    <div class="streak-row" id="streak-row">
                        <span class="streak-flame">🔥</span>
                        <span>连续签到 <span id="streak-count">0</span> 天</span>
                    </div>
                    <div class="badges-row" id="badges-row"></div>
                </div>
            </div>

            <div class="time-container">
                <div id="time">00:00:00</div>
                <div id="date">YYYY年MM月DD日 星期X</div>
            </div>

            <div class="fortune-container" id="fortune-container">
                <div class="fortune-card" id="fortune-card">
                    <span class="fortune-icon">✨</span>
                    <span class="fortune-text" id="fortune-text">点击抽取今日运势</span>
                </div>
            </div>

            <div class="msg-board" id="msg-board">
                <div class="msg-latest" id="msg-latest">
                    <span class="msg-icon">💬</span>
                    <span class="msg-content" id="msg-content">还没有留言，点击说点什么~</span>
                </div>
            </div>
        </div>
    </main>

    <!-- 留言输入浮层 -->
    <div class="msg-overlay" id="msg-overlay">
        <div class="msg-modal">
            <div class="msg-modal-title">给大家留句话 😺</div>
            <input type="text" id="msg-input" class="msg-input" placeholder="想说什么~" maxlength="30" autocomplete="off">
            <div class="msg-modal-actions">
                <button class="msg-cancel-btn" id="msg-cancel">算了</button>
                <button class="msg-send-btn" id="msg-send">发送</button>
            </div>
        </div>
    </div>

    <!-- 随机事件弹窗 -->
    <div class="event-popup" id="event-popup">
        <span class="event-icon" id="event-icon">🦋</span>
        <span class="event-text" id="event-text"></span>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js" defer></script>
    <script src="script.js" defer></script>
</body>

</html>